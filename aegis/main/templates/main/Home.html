{% extends 'main/layout.html' %}
{% load static %}

{% block title %}
Главная страница | ФК Аегис
{% endblock %}

  {% block css %}
    <link href="{% static 'main/css/home.css' %}" rel="stylesheet">
    <link href="{% static 'main/css/new.css' %}" rel="stylesheet">
    <link href="{% static 'main/css/carusel.css' %}" rel="stylesheet">
    <link href="{% static 'main/css/players.css' %}" rel="stylesheet">
  {% endblock %}

  {% block content %}
<main>

    <div id="myCarousel" class="carousel slide" data-bs-ride="carousel">
      <div class="carousel-indicators">
        <button type="button" data-bs-target="#myCarousel" data-bs-slide-to="0" class="active" aria-label="Slide 1" aria-current="true"></button>
        <button type="button" data-bs-target="#myCarousel" data-bs-slide-to="1" aria-label="Slide 2" class=""></button>
        <button type="button" data-bs-target="#myCarousel" data-bs-slide-to="2" aria-label="Slide 3" class=""></button>
      </div>
      <div class="carousel-inner">
        <div class="carousel-item active">
          <img width="100%" height="100%" src="{% static 'main/img/HomeAE/Обложка1.jpg' %}">
        </div>
        <div class="carousel-item">
          <img width="100%" height="100%" src="{% static 'main/img/HomeAE/shop_img.jpg' %}">
          <div class="container">
            <div class="carousel-caption textCarousel">
              <h1>Клубный магазин</h1>
              <p>Вы можете приобрести в магазине мерч ФК Аегис</p>
              <p><a class="btn btn-lg btn-secondary" href="{% url 'shop' %}">Магазин</a></p>
            </div>
          </div>
        </div>
        <div class="carousel-item">
          <img width="100%" height="100%" src="{% static 'main/img/HomeAE/Обложка3.jpg' %}">
          <div class="container">
            <div class="carousel-caption text-end textCarousel">
              <h1>Подпишись!</h1>
              <p>Следите за новостями в нашей группе во ВКонтакте.</p>
              <p><a class="btn btn-lg btn-primary" href="https://vk.com/fc.aegis">Перейти</a></p>
            </div>
          </div>
        </div>
      </div>
      <button class="carousel-control-prev" type="button" data-bs-target="#myCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#myCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>
  
    <div class="container" style="margin-left: 180px;">
    <div class="row" style="margin-top: 20px;">
      {% for n in news %}
      <div class="col-lg-3 col-md-4 col-7 m-3 p-0">
      <a href="{% url 'news' n.slug %}">
            <div class="g-0 border rounded overflow-hidden flex-md-row mb-4 shadow-sm position-relative nw">         
            <div style=" float: left;">
                <img  height="200px"  src="{{ n.img.url }}">
            </div>
              <a class="nw" href="{% url 'news' n.slug %}">
              
            <div class="col p-4 d-flex flex-column position-static">
              <div class="mb-0 title">{{ n.title }}</div>
              <div class="d-flex justify-content-end datetime">
                <p>{{ n.date_time }}</p>
              </div>
            </div>
          </a>  
        </div>           
      </a>
    </div>
      {% endfor %} 
    </div>
    </div>

    <div class="container marketing border-top">
      <h3 class="text-center" style="margin-bottom: 50px; margin-top: 20px;">Основатели Аегиса</h3>
      <div class="row">
        <div class="col-lg-4 col-md-4">
          <a class="creators" href="https://vk.com/davzakaryan">
          <img class="bd-placeholder-img rounded-circle" src="{% static 'main/img/HomeAE/David.jpg' %}" width="140" height="140">
          <h2 class="fw-normal">Давид Закарян</h2>          
        </a>
        </div>
        <div class="col-lg-4 col-md-4">
          <a class="creators" href="https://vk.com/supremex3000">
          <img class="bd-placeholder-img rounded-circle" src="{% static 'main/img/HomeAE/Sergey.jpg' %}" width="140" height="140">
          <h2 class="fw-normal">Сергей Павлов</h2>    
        </a>      
        </div>
        <div class="col-lg-4 col-md-4">
          <a class="creators" href="https://vk.com/johnblec">
          <img class="bd-placeholder-img rounded-circle" src="{% static 'main/img/HomeAE/Pavel.jpg' %}" width="140" height="140">
          <h2 class="fw-normal">Павел Сафин</h2>  
        </a>        
        </div>
      </div>
      <div class="row">
        <div class="col-lg-4 col-md-4 creators">
          <a class="creators" href="https://vk.com/id142459382">
          <img class="bd-placeholder-img rounded-circle" src="{% static 'main/img/HomeAE/Mikayel.jpg' %}" width="140" height="140">
           <h2 class="fw-normal">Микаел Нуроян</h2>
          </a>
        </div>
        <div class="col-lg-4 col-md-4 creators">
          <a class="creators" href="https://vk.com/lensy_boy">
          <img class="bd-placeholder-img rounded-circle" src="{% static 'main/img/HomeAE/Leonid.jpg' %}" width="140" height="140">
          <h2 class="fw-normal">Леонид Кармашов</h2>         
        </a>
        </div>
      </div>
    </div>
    <div class="container border-top">
      <h3 class="text-center"  style="margin-bottom: 50px; margin-top: 20px;">Состав команды</h3>
      <div id="container">
        <div id="slider-container">
          <span onclick="slideRight()" class="btn"></span>
            <div id="slider">
              {% for plrs in plrs %}
              <div class="slide">           
                <div class="m-0 p-0" style="border: 1px solid black;">
                  <a href="{% url 'details_player' plrs.slug %}">
                  {% if plrs.photo == NULL %}
                    <img class="img-fluid mx-auto d-block" src="{% static 'main/img/PlayersAE/NoPhoto.png' %}" alt="...">
                  {% else %}
                  <img class="img-fluid mx-auto d-block" src="{{ plrs.photo.url }}" alt="...">
                  {% endif %}
                    <div class="background"><a class="number">{{ plrs.number }} </a><a class="surename">{{ plrs.last_name }}</a></div>
                </a>
                </div>               
              </div>
              {% endfor %}
          </div>
          <span onclick="slideLeft()" class="btn"></span>
        </div>
      </div>
    </div> 
  </main>

  <script>
    var container = document.getElementById('container')
    var slider = document.getElementById('slider');
    var slides = document.getElementsByClassName('slide').length;
    var buttons = document.getElementsByClassName('btn');
    
    
    var currentPosition = 0;
    var currentMargin = 0;
    var slidesPerPage = 0;
    var slidesCount = slides - slidesPerPage;
    var containerWidth = container.offsetWidth;
    var prevKeyActive = false;
    var nextKeyActive = true;
    
    window.addEventListener("resize", checkWidth);
    
    function checkWidth() {
        containerWidth = container.offsetWidth;
        setParams(containerWidth);
    }
    
    function setParams(w) {
        if (w < 551) {
            slidesPerPage = 1;
        } else {
            if (w < 901) {
                slidesPerPage = 2;
            } else {
                if (w < 1101) {
                    slidesPerPage = 3;
                } else {
                    slidesPerPage = 4;
                }
            }
        }
        slidesCount = slides - slidesPerPage;
        if (currentPosition > slidesCount) {
            currentPosition -= slidesPerPage;
        };
        currentMargin = - currentPosition * (100 / slidesPerPage);
        slider.style.marginLeft = currentMargin + '%';
        if (currentPosition > 0) {
            buttons[0].classList.remove('inactive');
        }
        if (currentPosition < slidesCount) {
            buttons[1].classList.remove('inactive');
        }
        if (currentPosition >= slidesCount) {
            buttons[1].classList.add('inactive');
        }
    }
    
    setParams();
    
    function slideRight() {
        if (currentPosition != 0) {
            slider.style.marginLeft = currentMargin + (100 / slidesPerPage) + '%';
            currentMargin += (100 / slidesPerPage);
            currentPosition--;
        };
        if (currentPosition === 0) {
            buttons[0].classList.add('inactive');
        }
        if (currentPosition < slidesCount) {
            buttons[1].classList.remove('inactive');
        }
    };
    
    function slideLeft() {
        if (currentPosition != slidesCount) {
            slider.style.marginLeft = currentMargin - (100 / slidesPerPage) + '%';
            currentMargin -= (100 / slidesPerPage);
            currentPosition++;
        };
        if (currentPosition == slidesCount) {
            buttons[1].classList.add('inactive');
        }
        if (currentPosition > 0) {
            buttons[0].classList.remove('inactive');
        }
    };
    </script>
{% endblock %}
