{% extends 'main/layout.html' %}
{% load main_tags %}
{% load static %}

{% block title %}
{{ mtch.home_team.name }} - {{ mtch.away_team.name }} | ФК Аегис
{% endblock %}

  {% block css %}
    <link href="{% static 'main/css/stats_match.css' %}" rel="stylesheet">
    <link href="{% static 'main/css/players.css' %}" rel="stylesheet">
    <link href="{% static 'main/css/carusel.css' %}" rel="stylesheet">
  {% endblock %}

{% block content %}

<div class="scoreboard">
  <div class="scoreboard__container">
    <div class="scoreboard__basics mb-05">
      <span class="label">
        Конец матча
      </span>
      <span class="text-danger">
   
      </span>
    </div>
    <div class="scoreboard__teams">
      <div class="scoreboard__team scoreboard__team--align-right mr-2">
        <div class="scoreboard__badge ml-1">
          <img src="{{ mtch.home_team.logo.url }}" alt="{{ mtch.home_team.name }}"/>
        </div>
        <span class="scoreboard__name">{{ mtch.home_team.name }}</span>
      </div>
      <div class="scoreboard__result">
        <span class="scoreboard__result-home">{{ mtch.home_goals }}</span>
        <span class="scoreboard__result-separator">:</span>
        <span class="scoreboard__result-home">{{ mtch.away_goals }}</span>
      </div>
      <div class="scoreboard__team scoreboard__team--align-left ml-2">
        <div class="scoreboard__badge mr-1">
          <img src="{{ mtch.away_team.logo.url }}" alt="{{ mtch.away_team.name }}" />
        </div>
        <span class="scoreboard__name">{{ mtch.away_team.name }}</span>
      </div>
    </div>
  </div>
</div>
<div class="container">
  <nav>
    <div class="nav nav-tabs scoreboard__nav" id="nav-tab" role="tablist">
      <a class="nav-item scoreboard__nav-el active" id="nav-live-tab" data-bs-toggle="tab" href="#nav-live" role="tab" aria-controls="nav-live" aria-selected="true">События</a>
      <a class="nav-item scoreboard__nav-el" id="nav-stats-tab" data-bs-toggle="tab" href="#nav-stats" role="tab" aria-controls="nav-stats" aria-selected="false">Состав</a>
    </div>
  </nav>
  <div class="tab-content py-3 px-3 px-sm-0" id="nav-tabContent">
    <div class="tab-pane fade show active" id="nav-live" role="tabpanel" aria-labelledby="nav-live-tab">
      <div class="timeline">
        <div class="outer">
          <div class="card">
            <div class="info">
              <h3 class="title">ГОЛ!</h3>
              <p>Павлов оформляет дубль!</p>
            </div>
          </div>
          <div class="card">
            <div class="info">
              <h3 class="title">ГОЛ!</h3>
              <p>Чечин забивает второй гол команды!</p>
            </div>
          </div>
          <div class="card">
            <div class="info">
              <h3 class="title">ГОЛ!</h3>
              <p>Дебютный гол Полякова!</p>
            </div>
          </div>
          <div class="card">
            <div class="info">
              <h3 class="title">ГОЛ!</h3>
              <p>Мяч в сетке, благодоря удару Павлова.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="tab-pane fade" id="nav-stats" role="tabpanel" aria-labelledby="nav-stats-tab">
      <div id="container">
        <div id="slider-container">
          <span onclick="slideRight()" class="btn"></span>
            <div id="slider">
              {% for scr in scr %}
              <div class="slide">           
                <div class=" m-0 p-0" style="border: 1px solid black;">
                  <a href="{% url 'details_player' scr.player.slug %}">
                  {% if scr.player.photo == NULL %}
                    <img class="img-fluid mx-auto d-block" src="{% static 'main/img/PlayersAE/NoPhoto.png' %}" alt="...">
                  {% else %}
                  <img class="img-fluid mx-auto d-block" src="{{ scr.player.photo.url }}" alt="...">
                  {% endif %}
                    <div class="background"><a class="number">{{ scr.player.number }} </a><a class="surename">{{ scr.player.last_name }}</a></div>
                </a>
                </div>               
              </div>
              {% endfor %}
          </div>
          <span onclick="slideLeft()" class="btn"></span>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
var container = document.getElementById('container')
var slider = document.getElementById('slider');
var slides = document.getElementsByClassName('slide').length;
var buttons = document.getElementsByClassName('btn');


var currentPosition = 0;
var currentMargin = 0;
var slidesPerPage = 0;
var slidesCount = slides - slidesPerPage;
var containerWidth = container.offsetWidth;
var prevKeyActive = false;
var nextKeyActive = true;

window.addEventListener("resize", checkWidth);

function checkWidth() {
    containerWidth = container.offsetWidth;
    setParams(containerWidth);
}

function setParams(w) {
    if (w < 551) {
        slidesPerPage = 1;
    } else {
        if (w < 901) {
            slidesPerPage = 2;
        } else {
            if (w < 1101) {
                slidesPerPage = 3;
            } else {
                slidesPerPage = 4;
            }
        }
    }
    slidesCount = slides - slidesPerPage;
    if (currentPosition > slidesCount) {
        currentPosition -= slidesPerPage;
    };
    currentMargin = - currentPosition * (100 / slidesPerPage);
    slider.style.marginLeft = currentMargin + '%';
    if (currentPosition > 0) {
        buttons[0].classList.remove('inactive');
    }
    if (currentPosition < slidesCount) {
        buttons[1].classList.remove('inactive');
    }
    if (currentPosition >= slidesCount) {
        buttons[1].classList.add('inactive');
    }
}

setParams();

function slideRight() {
    if (currentPosition != 0) {
        slider.style.marginLeft = currentMargin + (100 / slidesPerPage) + '%';
        currentMargin += (100 / slidesPerPage);
        currentPosition--;
    };
    if (currentPosition === 0) {
        buttons[0].classList.add('inactive');
    }
    if (currentPosition < slidesCount) {
        buttons[1].classList.remove('inactive');
    }
};

function slideLeft() {
    if (currentPosition != slidesCount) {
        slider.style.marginLeft = currentMargin - (100 / slidesPerPage) + '%';
        currentMargin -= (100 / slidesPerPage);
        currentPosition++;
    };
    if (currentPosition == slidesCount) {
        buttons[1].classList.add('inactive');
    }
    if (currentPosition > 0) {
        buttons[0].classList.remove('inactive');
    }
};
</script>
{% endblock %}